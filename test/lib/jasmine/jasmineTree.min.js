/*! 
jasmineTree 2.0 2018-04-22T15:24:57.999Z
https://github.com/MassimoFoti/jasmineTree
Copyright 2015-2018 Massimo Foti (massimo@massimocorner.com) and Emily Meroni (emily.meroni@gmail.com)
Licensed under the Apache License, Version 2.0 | http://www.apache.org/licenses/LICENSE-2.0
 */
void 0===window.jasmineTree&&(window.jasmineTree={}),function(){"use strict";jasmineTree.version="2.0";const CONST={CSS_CLASSES:{SUMMARY:"jasmine-tree-summary",TRIGGER:"jasmine-tree-trigger",TOOLBAR:"jasmine-tree-toolbar",BUTTON:"jasmine-tree-button",NODE_OPENED:"jasmine-tree-opennode"},SELECTORS:{FIRST_CHILD:":first-child",SUMMARY:".jasmine-summary",ROOT_SUITE:".jasmine-summary > .jasmine-suite",NODE_TITLE:"li.jasmine-suite-detail",NODE_SPECS:"ul.jasmine-specs",NODE_SUITES:"ul.jasmine-suite"},TEXT:{COLLAPSE:"Collapse All",EXPAND:"Expand All",SEPARATOR:" | ",PLUS:"+",MINUS:"-"},FILTER_REGEXP:new RegExp("[?&]spec=([^&]*)")},rootSuites=[];jasmineTree.getSpecFilter=function(searchStr){const match=CONST.FILTER_REGEXP.exec(searchStr);if(null!==match){const filter=decodeURIComponent(match[1].replace(/\+/g," "));if(""!==filter)return filter}},jasmineTree.collapseAll=function(){for(let i=0;i<rootSuites.length;i++)rootSuites[i].collapse()},jasmineTree.expandAll=function(){for(let i=0;i<rootSuites.length;i++)rootSuites[i].expand()},jasmineTree.addRootClass=function(){document.querySelector(CONST.SELECTORS.SUMMARY).classList.add(CONST.CSS_CLASSES.SUMMARY)},jasmineTree.addToolbar=function(){const toolbar=document.createElement("div");toolbar.classList.add(CONST.CSS_CLASSES.TOOLBAR);const collapse=document.createElement("span");collapse.classList.add(CONST.CSS_CLASSES.BUTTON),collapse.textContent=CONST.TEXT.COLLAPSE,toolbar.appendChild(collapse);const separator=document.createElement("span");separator.textContent=CONST.TEXT.SEPARATOR,toolbar.appendChild(separator);const expand=document.createElement("span");expand.classList.add(CONST.CSS_CLASSES.BUTTON),expand.textContent=CONST.TEXT.EXPAND,toolbar.appendChild(expand),collapse.addEventListener("click",function(event){event.preventDefault(),jasmineTree.collapseAll()}),expand.addEventListener("click",function(event){event.preventDefault(),jasmineTree.expandAll()});const summaryNode=document.querySelector(CONST.SELECTORS.SUMMARY);summaryNode.parentNode.insertBefore(toolbar,summaryNode)},jasmineTree.filterSpec=function(){const filter=jasmineTree.getSpecFilter(window.location.search);if(void 0!==filter){jasmineTree.collapseAll();for(let i=0;i<rootSuites.length;i++)!0===rootSuites[i].containsPath(filter)&&rootSuites[i].expand()}},jasmineTree.Suite=function(options){const config={rootNode:options.rootNode,rootPath:options.rootPath};void 0===config.rootPath&&(config.rootPath="");const self=this,suites=[],specs=[];let fullPath="",expanded=!0;const triggerNode=document.createElement("a");triggerNode.classList.add(CONST.CSS_CLASSES.TRIGGER),triggerNode.textContent=CONST.TEXT.MINUS;const attachEvents=function(){triggerNode.addEventListener("click",function(event){event.preventDefault(),!0===expanded?self.collapse():self.expand()})},nodeMatches=function(node,selector){let methodName="matches";return void 0===node.matches&&void 0!==node.msMatchesSelector&&(methodName="msMatchesSelector"),node[methodName](selector)};this.getPath=function(){return fullPath},this.containsPath=function(path){if(!0==(str=self.getPath(),subStr=path,str.substring(0,subStr.length)===subStr))return!0;var str,subStr;for(let j=0;j<specs.length;j++){if(self.getPath()+" "+specs[j].textContent.trim()===path)return!0}for(let i=0;i<suites.length;i++)if(!0===suites[i].containsPath(path))return!0;return!1},this.show=function(){config.rootNode.style.display="block"},this.hide=function(){config.rootNode.style.display="none"},this.collapse=function(){config.rootNode.classList.remove(CONST.CSS_CLASSES.NODE_OPENED),triggerNode.textContent=CONST.TEXT.PLUS;for(let i=0;i<suites.length;i++)suites[i].collapse(),suites[i].hide();for(let j=0;j<specs.length;j++)specs[j].style.display="none";expanded=!1},this.expand=function(){config.rootNode.classList.add(CONST.CSS_CLASSES.NODE_OPENED),triggerNode.textContent=CONST.TEXT.MINUS;for(let i=0;i<suites.length;i++)suites[i].expand(),suites[i].show();for(let j=0;j<specs.length;j++)specs[j].style.display="block";expanded=!0},function(){let titleNode;config.rootNode.classList.add(CONST.CSS_CLASSES.NODE_OPENED),Array.prototype.slice.call(config.rootNode.children).forEach(function(item){!0===nodeMatches(item,CONST.SELECTORS.NODE_TITLE)&&(titleNode=item)}),fullPath=config.rootPath+titleNode.textContent.trim();const linkNode=titleNode.querySelector(CONST.SELECTORS.FIRST_CHILD);linkNode.parentNode.insertBefore(triggerNode,linkNode),Array.prototype.slice.call(config.rootNode.children).forEach(function(item){!0===nodeMatches(item,CONST.SELECTORS.NODE_SPECS)&&specs.push(item)}),Array.prototype.slice.call(config.rootNode.children).forEach(function(item){if(!0===nodeMatches(item,CONST.SELECTORS.NODE_SUITES)){const childSuite=new jasmineTree.Suite({rootNode:item,rootPath:fullPath+" "});suites.push(childSuite)}}),attachEvents()}()},jasmineTree.init=function(){Array.prototype.slice.call(document.querySelectorAll(CONST.SELECTORS.ROOT_SUITE)).forEach(function(item){const suite=new jasmineTree.Suite({rootNode:item});rootSuites.push(suite)}),jasmineTree.addRootClass(),jasmineTree.addToolbar(),jasmineTree.filterSpec()},void 0===window.__karma__&&jasmine.getEnv().addReporter({jasmineDone:function(){jasmineTree.init()}})}();
//# sourceMappingURL=jasmineTree.min.js.map
